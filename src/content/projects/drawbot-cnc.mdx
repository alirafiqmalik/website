---
slug: drawbot-cnc
title: 2D CNC Machine (Drawbot)
description: G-code controlled drawing robot with motion planning algorithms
img: assets/img/drawbot.jpg
importance: 6
category: Embedded Systems
technologies: [C/C++, Python, Arduino, G-code]
status: Completed
links:
  github: "#"
---

This project brings digital designs into the physical world through a custom-built CNC drawing machine. By implementing G-code parsing and motion control algorithms from scratch, the system translates vector graphics into precise mechanical movements, demonstrating the fundamentals of computer-controlled manufacturing.

## System Architecture

The drawbot consists of three main subsystems working in coordination:

**Mechanical**: XY gantry system using timing belts and linear rails for smooth, accurate motion. A servo-controlled pen lift mechanism enables drawing and positioning moves.

**Electrical**: Stepper motor drivers providing the current and control signals needed to drive NEMA 17 motors. An Arduino microcontroller orchestrates all motion.

**Software**: Embedded C/C++ firmware parsing G-code commands and generating precisely timed step pulses.

## G-Code Parsing

The firmware implements a G-code interpreter supporting standard commands:

- **G00/G01**: Rapid positioning and linear interpolation moves
- **G02/G03**: Circular interpolation (clockwise and counterclockwise arcs)
- **M03/M05**: Pen up and pen down commands
- **G90/G91**: Absolute and relative positioning modes

The parser extracts parameters from each command and validates them before execution, ensuring safe operation and catching malformed input.

## Motion Planning and Control

Translating high-level G-code commands into stepper motor movements requires sophisticated motion planning:

**Bresenham Line Algorithm**: For straight-line moves, this algorithm determines which steps to take on each axis, ensuring the mechanical path closely approximates the desired line while using only integer arithmetic.

**Acceleration Profiles**: Rather than instantly jumping to target speeds (which would cause missed steps and vibration), the system implements trapezoidal velocity profiles. Moves begin with gradual acceleration, proceed at constant velocity, then decelerate smoothly to the endpoint.

**Step Synchronization**: When both axes must move simultaneously (diagonal lines), the firmware precisely times step pulses to maintain the correct ratio of X to Y movement throughout the motion.

## Timing and Precision

Achieving precise drawings requires careful attention to timing:

**Stepper Resolution**: With 200 steps per revolution and 16x microstepping, motors provide 3,200 steps per revolution. Combined with timing belt mechanics, this yields positioning resolution of approximately 0.012mm.

**Interrupt-Driven Stepping**: Timer interrupts generate step pulses with microsecond precision, independent of other processing tasks. This ensures consistent motion even while parsing the next G-code command.

**Backlash Compensation**: Software compensation adjusts for mechanical backlash in the drive system, ensuring accuracy when changing direction.

## Python Toolchain

A Python toolchain bridges the gap between design software and machine control:

- **SVG Parsing**: Extracts vector paths from standard SVG files
- **Path Optimization**: Reorders paths to minimize pen-up travel time
- **G-Code Generation**: Converts optimized paths into G-code with appropriate speeds and pen control
- **Simulation**: Visualizes the drawing path before sending to hardware

## Example Outputs

The drawbot successfully renders complex drawings including:

- Technical diagrams and CAD designs
- Typography and calligraphy
- Artistic illustrations with intricate detail
- PCB silkscreen patterns for electronics fabrication

Drawing accuracy of ±0.1mm is achieved consistently across the 300mm × 300mm work area.
